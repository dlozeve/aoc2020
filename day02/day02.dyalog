 p←↑¨{⍵⊆⍨~⍵∊':- '}¨⊃⎕NGET'input'1
 +/{((⍎1⌷⍵),1+⍎2⌷⍵)(1=⍸)+/(⊃3⌷⍵)⍷4⌷⍵}¨p  ⍝ Part 1
 +/{≠/(⊃3⌷⍵)=(4⌷⍵)[⍎¨↓(⊂1 2)⌷⍵]}¨p  ⍝ Part 2
